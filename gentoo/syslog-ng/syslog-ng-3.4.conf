@version: 3.4
# $Header: /var/cvsroot/gentoo-x86/app-admin/syslog-ng/files/3.4/syslog-ng.conf.gentoo,v 1.2 2013/06/02 01:18:35 mr_bones_ Exp $
#
# Syslog-ng default configuration file for Gentoo Linux

options {
  threaded(yes);
  stats_freq(43200);
  mark_freq(3600);
  flush_lines (0);
  time_reopen (10);
  log_fifo_size (10000);
  chain_hostnames (no);
  use_dns (no);
  use_fqdn (no);
  create_dirs (no);
  keep_hostname (yes);
  perm(0640);
};

# https://bugs.gentoo.org/show_bug.cgi?id=426814
@include "scl.conf"

source src {
  # unix-dgram("/dev/log");
  # file("/proc/kmsg");
  system();
  internal();
};

# template t_test { template("PROGRAM=$PROGRAM@PID=$PID@BSDTAG=$BSDTAG@TAG=$TAG@TAGS=$TAGS@FACILITY=$FACILITY@FACILITY_NUM=$FACILITY_NUM@LEVEL=$LEVEL@LEVEL_NUM=$LEVEL_NUM@PRI=$PRI@PRIORITY=$PRIORITY@FULLHOST=$FULLHOST@FULLHOST_FROM=$FULLHOST_FROM@HOST=$HOST@HOST_FROM=$HOST_FROM@LOGHOST=$LOGHOST@MSGHDR=$MSGHDR@MSGID=$MSGID@MSGONLY=$MSGONLY@MSG=$MSG@MESSAGE=$MESSAGE@SOURCE=$SOURCE@SOURCEIP=$SOURCEIP@SOURCE_IP=$SOURCE_IP@SEQNUM=$SEQNUM@UNIXTIME=$UNIXTIME@FULLDATE=$FULLDATE@ISODATE=$ISODATE@DATE=$DATE@STAMP=$STAMP@TZ=$TZ@TZOFFSET=$TZOFFSET@SEC=$SEC@MIN=$MIN@HOUR=$HOUR@HOUR12=$HOUR12@DAY=$DAY@WEEK=$WEEK@WEEK_DAY=$WEEK_DAY@WEEK_DAY_ABBREV=$WEEK_DAY_ABBREV@WEEK_DAY_NAME=$WEEK_DAY_NAME@MONTH=$MONTH@MONTH_ABBREV=$MONTH_ABBREV@MONTH_NAME=$MONTH_NAME@MONTH_WEEK=$MONTH_WEEK@YEAR=$YEAR@YEAR_DAY=$YEAR_DAY\n"); template_escape(no); };


#
# destinations
#
# destination d_lpr { file("/var/log/lpr.log"); };
# destination d_uucp { file("/var/log/uucp.log"); };
# destination d_ppp { file("/var/log/ppp.log"); };
# destination d_debug { file("/var/log/debug.log"); };
# destination d_iptables { file("/var/log/iptables.log"); };
#
destination d_console { usertty("root"); };
destination d_authlog { file("/var/log/hosts/$HOST/auth-$YEAR$MONTH$DAY.log"
owner(root) group(root) perm(0600) dir_perm(0700)  create_dirs(yes)); };

destination d_syslog { file("/var/log/hosts/$HOST/syslog-$YEAR$MONTH$DAY.log"
owner(root) group(root) perm(0600) dir_perm(0700)  create_dirs(yes)); };

destination d_cron { file("/var/log/hosts/$HOST/crond-$YEAR$MONTH$DAY.log"
owner(root) group(root) perm(0600) dir_perm(0700)  create_dirs(yes)); };

destination d_daemon { file("/var/log/hosts/$HOST/daemon-$YEAR$MONTH$DAY.log"
owner(root) group(root) perm(0600) dir_perm(0700)  create_dirs(yes)); };

destination d_kernel { file("/var/log/hosts/$HOST/kernel-$YEAR$MONTH$DAY.log"
owner(root) group(root) perm(0600) dir_perm(0700)  create_dirs(yes)); };

destination d_user { file("/var/log/hosts/$HOST/user-$YEAR$MONTH$DAY.log"
owner(root) group(root) perm(0600) dir_perm(0700)  create_dirs(yes)); };

destination d_mail { file("/var/log/hosts/$HOST/mail-$YEAR$MONTH$DAY.log"
owner(root) group(root) perm(0600) dir_perm(0700)  create_dirs(yes)); };

destination d_news { file("/var/log/hosts/$HOST/news-$YEAR$MONTH$DAY.log"
owner(root) group(root) perm(0600) dir_perm(0700)  create_dirs(yes)); };

destination d_messages { file("/var/log/hosts/$HOST/messages-$YEAR$MONTH$DAY.log"
owner(root) group(root) perm(0600) dir_perm(0700)  create_dirs(yes)); };

destination d_errors { file("/var/log/hosts/$HOST/errors-$YEAR$MONTH$DAY.log"
owner(root) group(root) perm(0600) dir_perm(0700)  create_dirs(yes)); };

destination d_everything { file("/var/log/hosts/$HOST/everything-$YEAR$MONTH$DAY.log"
owner(root) group(root) perm(0600) dir_perm(0700)  create_dirs(yes)); };

destination d_acpid { file("/var/log/hosts/$HOST/acpid-$YEAR$MONTH$DAY.log"
owner(root) group(root) perm(0600) dir_perm(0700)  create_dirs(yes)); };

# Log everything to tty12
destination console_all { file("/dev/tty12"); };

# filter f_lpr { facility(lpr); };
# filter f_uucp { facility(uucp); };
# filter f_ppp { facility(local2); };
# filter f_debug { not facility(auth, authpriv, news, mail); };
filter f_iptables { match("IN=" value("MESSAGE")) and match("OUT=" value("MESSAGE")); };
filter f_auth { facility(auth); };
filter f_authpriv { facility(auth, authpriv); };
filter f_syslog { program(syslog-ng); };
filter f_cron { facility(cron); };
filter f_daemon { facility(daemon); };
filter f_kernel { facility(kern) and not filter(f_iptables); };
filter f_mail { facility(mail); };
filter f_news { facility(news); };
filter f_user { facility(user); };
filter f_messages { level(info..warn) and not facility(auth, authpriv, mail, news, cron) and not program(syslog-ng) and not filter(f_iptables); };
filter f_everything { level(debug..emerg) and not facility(auth, authpriv, local2); };
filter f_emergency { level(emerg); };
filter f_info { level(info); };
filter f_notice { level(notice); };
filter f_warn { level(warn); };
filter f_crit { level(crit); };
filter f_err { level(err); };
filter f_acpid { program("acpid"); };

# log { source(src); filter(f_lpr); destination(d_lpr); };
# log { source(src); filter(f_ppp); destination(d_ppp); };
# log { source(src); filter(f_uucp); destination(d_uucp); };
# log { source(src); filter(f_debug); destination(d_debug); };
# log { source(src); filter(f_iptables); destination(d_iptables); };
log { source(src); filter(f_acpid); destination(d_acpid); };
log { source(src); filter(f_authpriv); destination(d_authlog); };
log { source(src); filter(f_syslog); destination(d_syslog); };
log { source(src); filter(f_cron); destination(d_cron); };
log { source(src); filter(f_daemon); destination(d_daemon); };
log { source(src); filter(f_kernel); destination(d_kernel); };
log { source(src); filter(f_mail); destination(d_mail); };
log { source(src); filter(f_news); destination(d_news); };
log { source(src); filter(f_user); destination(d_user); };
log { source(src); filter(f_messages); destination(d_messages); };
log { source(src); filter(f_err); destination(d_errors); };
log { source(src); filter(f_emergency); destination(d_console); };
log { source(src); filter(f_everything); destination(d_everything); };

# Log everything to tty12
log { source(src); destination(console_all); };
